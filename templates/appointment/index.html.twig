{% extends 'base.html.twig' %}

{% block title %} Book your appointment!{% endblock %}

{% block stylesheet %}
    <!--timepicker-->
    <link href='{{asset("js/jonthornton-jquery-timepicker/jquery.timepicker.min.css")}}' rel="stylesheet" />
{% endblock %}

{% block main %}
<style>
    .form-select{
        height: 55px;
    }
</style>
        <body> 
            <!-- Appointment Start -->
            <div class="container-fluid py-5">
                <div class="container">
                    <div class="row gx-5">
                        <div class="col-lg-6 mb-5 mb-lg-0">
                            <div class="mb-4">
                                <h5 class="d-inline-block text-primary text-uppercase border-bottom border-5">Appointment</h5>
                                <h1 class="display-4">Make An Appointment For Your Family</h1>
                            </div>
                            <p class="mb-5">Eirmod sed tempor lorem ut dolores. Aliquyam sit sadipscing kasd ipsum. Dolor ea et dolore et at sea ea at dolor, justo ipsum duo rebum sea invidunt voluptua. Eos vero eos vero ea et dolore eirmod et. Dolores diam duo invidunt lorem. Elitr ut dolores magna sit. Sea dolore sanctus sed et. Takimata takimata sanctus sed.</p>
                            <a class="btn btn-primary rounded-pill py-3 px-5 me-3" href="">Find Doctor</a>
                            <a class="btn btn-outline-primary rounded-pill py-3 px-5" href="">Read More</a>
                        </div>
                        <div class="col-lg-6">
                            <div class="bg-light text-center rounded p-5">
                                <h1 class="mb-4">Book An Appointment</h1>                   
                                    {{ form_start(form, {'attr': {'id': 'appointment_form'}}) }}
                                    <div class="row g-3">
                                        <div class="col-12 col-sm-6">
                                            {{ form_row(form.idDepartment)}}  
                                        </div>
                                        <div class="col-12 col-sm-6">
                                            {{ form_row(form.idDoctor)}}
                                        </div>
                                        <div class="col-12 col-sm-6">
                                            <input type="text" class="form-control bg-white border-0" placeholder="Your Name" style="height: 55px;">
                                        </div>
                                        <div class="col-12 col-sm-6">
                                            <input type="email" class="form-control bg-white border-0" placeholder="Your Email" style="height: 55px;">
                                        </div>
                                        <div class="col-12 col-sm-6">
                                            
                                            <div class="date" id="date" data-target-input="nearest">
                                                {{ form_row(form.appointmentDay)}}
                                            </div>
                                        </div>
                                        <div class="col-12 col-sm-6">
                                            <div class="time" id="time" data-target-input="nearest">
                                                {{ form_row(form.startTime)}}
                                                {{ form_row(form.endTime)}}

                                            </div>
                                        </div>
                                        <div class="col-12">
                                            {{ form_row(form.submit, { 'label': 'Reserver un rendez vous!' })}}
                                        </div>
                                    </div>
                                {{ form_end(form) }} 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Appointment End -->
            <!-- Back to Top -->  
{% endblock %}
{% block javascripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{{asset('js/jonthornton-jquery-timepicker/jquery.timepicker.min.js')}}"></script>
<script>
    var originalInput = null;
    $('#appointment_form_startTime').timepicker(({ 'timeFormat': 'H:i:s', 'forceRoundTime': true }))
    $("#appointment_form_idDepartment").on("change", function () {
        let $field = $(this)
        let $departmentField = $('#appointment_form_idDepartment')
        let $startTimeHourField = $('#appointment_form_startTime')
        let $startTimeMinField = $('#appointment_form_startTime_minute')
        let $endTimeHourField = $('#appointment_form_endTime_hour')
        let $endTimeMinField = $('#appointment_form_endTime_minute')
        let $rdvDayMonthField = $('#appointment_form_appointmentDay')
        let $rdvDayDayField = $('#appointment_form_appointmentDay_day')
        let $rdvDayYearField = $('#appointment_form_appointmentDay_year')
        let $form = $field.closest('form')
        let target = '#' + $field.attr('id').replace('departement', 'ville').replace('region', 'departement')
        // Les données à envoyer en Ajax 
        let data = {}
        data[$departmentField.attr('name')] = $departmentField.val() 
        data[$startTimeHourField.attr('name')] = $startTimeHourField.val() 
        data[$endTimeHourField.attr('name')] = $endTimeHourField.val() 
        data[$endTimeMinField.attr('name')] = $endTimeMinField.val() 
        data[$rdvDayMonthField.attr('name')] = $rdvDayMonthField.val()  

        //data[$field.attr('name')] = $field.val()
        // On soumet les données
        $.post($form.attr('action'), data).then(function (data) {
            // On récupère le nouveau <select>
            let $input = $(data).find('#appointment_form_idDoctor')
            // On remplace notre <select> actuel
            $input.addClass( ["form-select bg-white border-0"] )
            $originalInput =  $("#appointment_form_idDoctor")
            $originalInput.replaceWith($input)
        })
        })
       
</script>
<script> 
    /*if (!$( "#appointment_form_idDoctor").hasClass( "form-select bg-white border-0" )) {
         $("#appointment_form_idDoctor").addClass( ["form-select bg-white border-0"] ) 
    }
     $( "#appointment_form" ).submit(function( event ) {
            $('#appointment_form_idDoctor').replaceWith($originalInput) 
        });
    */
   
</script>
{% endblock %}